"use strict";(self.webpackChunkneonwp=self.webpackChunkneonwp||[]).push([[5738],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,h=m["".concat(c,".").concat(d)]||m[d]||u[d]||o;return n?r.createElement(h,i(i({ref:t},s),{},{components:n})):r.createElement(h,i({ref:t},s))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4419:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return c},default:function(){return d},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return u}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=["components"],l={sidebar_position:3,title:"\u65e0\u6cd5\u5728 Solana \u4e2d\u4f7f\u7528\u7684\u9884\u7f16\u8bd1\u5408\u7ea6(Precompiled Contracts that can not be used in Solana)"},c=void 0,p={unversionedId:"09Architecture/05Architectural Limitations/03Precompiled Contracts that can not be used in Solana",id:"09Architecture/05Architectural Limitations/03Precompiled Contracts that can not be used in Solana",title:"\u65e0\u6cd5\u5728 Solana \u4e2d\u4f7f\u7528\u7684\u9884\u7f16\u8bd1\u5408\u7ea6(Precompiled Contracts that can not be used in Solana)",description:"\u95ee\u9898(Problem)",source:"@site/docs/09Architecture/05Architectural Limitations/03Precompiled Contracts that can not be used in Solana.md",sourceDirName:"09Architecture/05Architectural Limitations",slug:"/09Architecture/05Architectural Limitations/03Precompiled Contracts that can not be used in Solana",permalink:"/neonwp/09Architecture/05Architectural Limitations/03Precompiled Contracts that can not be used in Solana",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/09Architecture/05Architectural Limitations/03Precompiled Contracts that can not be used in Solana.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"\u65e0\u6cd5\u5728 Solana \u4e2d\u4f7f\u7528\u7684\u9884\u7f16\u8bd1\u5408\u7ea6(Precompiled Contracts that can not be used in Solana)"},sidebar:"tutorialSidebar",previous:{title:"Neon EVM\u4e0a\u4e0d\u652f\u6301\u7684\u4ee3\u5e01(Unsupported Tokens in Neon EVM)",permalink:"/neonwp/09Architecture/05Architectural Limitations/02Unsupported Tokens in Neon EVM"},next:{title:"\u6743\u76ca\u8bc1\u660e(Proof-of-Stake)",permalink:"/neonwp/09Architecture/05Architectural Limitations/04Neon and Ethereum Gas Calculators give different Results"}},s={},u=[{value:"\u95ee\u9898(Problem)",id:"\u95ee\u9898problem",level:4},{value:"\u7ec6\u8282(Details)",id:"\u7ec6\u8282details",level:4},{value:"\u89e3\u51b3\u65b9\u6848(Solution)",id:"\u89e3\u51b3\u65b9\u6848solution",level:4},{value:"\u5b9e\u65bd\u7b56\u7565(Implementation Strategy)",id:"\u5b9e\u65bd\u7b56\u7565implementation-strategy",level:4}],m={toc:u};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h4",{id:"\u95ee\u9898problem"},"\u95ee\u9898(Problem)"),(0,o.kt)("p",null,"Contracts written in the Solidity language cannot work in Solana if they contain calls to the following precompiled contracts:"),(0,o.kt)("p",null,"\u7528 Solidity \u8bed\u8a00\u7f16\u5199\u7684\u5408\u7ea6\u5982\u679c\u5305\u542b\u5bf9\u4ee5\u4e0b\u9884\u7f16\u8bd1\u5408\u7ea6\u7684\u8c03\u7528\uff0c\u5219\u65e0\u6cd5\u5728 Solana \u4e2d\u8fd0\u884c\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"bigModExp"))," \u2014 Used for efficient RSA verification inside of EVM, as well as other forms of number theory-based cryptography.",(0,o.kt)("br",{parentName:"p"}),"\n","",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"bigModExp"))," \u2014\u7528\u4e8e EVM \u5185\u90e8\u7684\u9ad8\u6548 RSA \u9a8c\u8bc1\uff0c\u4ee5\u53ca\u5176\u4ed6\u5f62\u5f0f\u7684\u57fa\u4e8e\u6570\u8bba\u7684\u5bc6\u7801\u5b66\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"bn256Add"))," \u2014 Performs addition on the elliptic curve operations.",(0,o.kt)("br",{parentName:"p"}),"\n","",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"bn256Add"))," \u2014\u5bf9\u692d\u5706\u66f2\u7ebf\u64cd\u4f5c\u8fdb\u884c\u52a0\u6cd5\u8fd0\u7b97\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"bn256ScalarMult"))," \u2014 Performs scalar multiplication on the elliptic curve operations.",(0,o.kt)("br",{parentName:"p"}),"\n","",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"bn256ScalarMult"))," \u2014 \u5bf9\u692d\u5706\u66f2\u7ebf\u64cd\u4f5c\u6267\u884c\u6807\u91cf\u4e58\u6cd5\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"bn256Pairing"))," \u2014 Elliptic curve pairing operations to perform zkSNARKs verification within the block gas limit.",(0,o.kt)("br",{parentName:"p"}),"\n","",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"bn256Pairing"))," \u2014 \u692d\u5706\u66f2\u7ebf\u914d\u5bf9\u64cd\u4f5c\uff0c\u5728\u533a\u5757\u7684gas\u4e0a\u9650\u5185\u6267\u884c zkSNARKs \u9a8c\u8bc1\u3002"))),(0,o.kt)("p",null,"Neon EVM requires the implementation of system calls in Solana for these contracts.  "),(0,o.kt)("p",null,"Neon EVM \u9700\u8981\u5728 Solana \u4e2d\u4e3a\u8fd9\u4e9b\u5408\u7ea6\u5b9e\u73b0\u7cfb\u7edf\u8c03\u7528\u3002"),(0,o.kt)("h4",{id:"\u7ec6\u8282details"},"\u7ec6\u8282(Details)"),(0,o.kt)("p",null,"A solidity contract can contain calls to functions supported by EVM itself. For example, to perform operations such as addition, subtraction, obtaining a hash block, a contract can use methods implemented in EVM. Each called function is an operation-code. EVM contains some such codes (in a limited number)."),(0,o.kt)("p",null,"Solidity \u5408\u7ea6\u53ef\u4ee5\u5305\u542b\u5bf9 EVM \u672c\u8eab\u652f\u6301\u51fd\u6570\u7684\u8c03\u7528\u3002\u4f8b\u5982\uff0c\u4e3a\u4e86\u6267\u884c\u52a0\u6cd5\u3001\u51cf\u6cd5\u3001\u83b7\u53d6\u54c8\u5e0c\u5757\u7b49\u64cd\u4f5c\uff0c\u5408\u7ea6\u53ef\u4ee5\u4f7f\u7528 EVM \u4e2d\u5df2\u6709\u7684\u65b9\u6cd5\u3002\u6bcf\u4e2a\u88ab\u8c03\u7528\u7684\u51fd\u6570\u90fd\u662f\u4e00\u4e2a\u64cd\u4f5c\u7801\u3002 EVM \u5305\u542b\u4e00\u4e9b\u8fd9\u6837\u7684\u4ee3\u7801(\u4f46\u6570\u91cf\u6709\u9650)\u3002"),(0,o.kt)("p",null,"To increase the number of such functions, precompiled contracts implemented inside the blockchain core are used. Since these contracts are written in Solidity, their use requires an increased consumption of resources (i.e. gas). Neon EVM contains several pieces of the program code where calls to these precompiled contracts can occur."),(0,o.kt)("p",null,"\u4e3a\u4e86\u589e\u52a0\u6b64\u7c7b\u529f\u80fd\u7684\u6570\u91cf\uff0c\u5c31\u4f7f\u7528\u4e86\u5728\u533a\u5757\u94fe\u6838\u5fc3\u5185\u90e8\u5b9e\u73b0\u7684\u9884\u7f16\u8bd1\u5408\u7ea6\u3002\u7531\u4e8e\u8fd9\u4e9b\u5408\u7ea6\u7528 Solidity \u7f16\u5199\uff0c\u56e0\u6b64\u5b83\u4eec\u7684\u4f7f\u7528\u9700\u8981\u589e\u52a0\u8d44\u6e90\u6d88\u8017(\u5373gas)\u3002 Neon EVM \u5305\u542b\u51e0\u6bb5\u7a0b\u5e8f\u4ee3\u7801\uff0c\u53ef\u4ee5\u8c03\u7528\u8fd9\u4e9b\u9884\u7f16\u8bd1\u7684\u5408\u7ea6\u3002"),(0,o.kt)("p",null,"If the program enters such places, Neon EVM does not create a new contract, but calls an already compiled contract from the blockchain core. Although these functions are called within the core, in the code it is like calling another contract. Since this code is executed directly in the core, it is resource intensive."),(0,o.kt)("p",null,"\u5982\u679c\u7a0b\u5e8f\u8fdb\u5165\u8fd9\u4e9b\u5730\u65b9\uff0cNeon EVM \u4e0d\u4f1a\u521b\u5efa\u65b0\u5408\u7ea6\uff0c\u800c\u662f\u4ece\u533a\u5757\u94fe\u6838\u5fc3\u8c03\u7528\u5df2\u7ecf\u7f16\u8bd1\u597d\u7684\u5408\u7ea6\u3002\u867d\u7136\u8fd9\u4e9b\u51fd\u6570\u662f\u5728\u6838\u5fc3\u4e2d\u8c03\u7528\u7684\uff0c\u4f46\u5728\u4ee3\u7801\u4e2d\u5c31\u50cf\u8c03\u7528\u53e6\u4e00\u4e2a\u5408\u7ea6\u4e00\u6837\u3002\u7531\u4e8e\u6b64\u4ee3\u7801\u76f4\u63a5\u5728\u5185\u6838\u4e2d\u6267\u884c\uff0c\u56e0\u6b64\u662f\u8d44\u6e90\u5bc6\u96c6\u578b\u7684(\u4f1a\u8017\u8d39\u5927\u91cf\u8d44\u6e90)\u3002"),(0,o.kt)("p",null,"Currently, there are several precompiled contracts implemented as bpf-code. When calling these contracts, a lot of bpf-instructions are used, and therefore, the transaction size limit may be exceeded."),(0,o.kt)("p",null,"\u76ee\u524d\uff0c\u6709\u51e0\u4e2a\u9884\u7f16\u8bd1\u5408\u7ea6\u5b9e\u73b0\u4e3a bpf \u4ee3\u7801\u3002\u5728\u8c03\u7528\u8fd9\u4e9b\u5408\u7ea6\u65f6\uff0c\u4f1a\u4f7f\u7528\u5927\u91cf\u7684 bpf \u6307\u4ee4\uff0c\u56e0\u6b64\u53ef\u80fd\u4f1a\u8d85\u51fa\u4ea4\u6613\u5927\u5c0f\u9650\u5236\u3002"),(0,o.kt)("h4",{id:"\u89e3\u51b3\u65b9\u6848solution"},"\u89e3\u51b3\u65b9\u6848(Solution)"),(0,o.kt)("p",null,"In order for the precompiled contracts to be used in Solana, it is proposed to implement sys-calls inside the Solana core. That is, to perform an implementation similar to the erc-recover implementation."),(0,o.kt)("p",null,"\u4e3a\u4e86\u5728 Solana \u4e2d\u4f7f\u7528\u9884\u7f16\u8bd1\u7684\u5408\u7ea6\uff0c\u5df2\u7ecf\u6709\u5efa\u8bae\u8981\u5728 Solana \u6838\u5fc3\u5185\u5b9e\u73b0\u7cfb\u7edf\u8c03\u7528\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6267\u884c\u7c7b\u4f3c\u4e8e erc-recover\u7684\u5b9e\u65bd\u3002"),(0,o.kt)("h4",{id:"\u5b9e\u65bd\u7b56\u7565implementation-strategy"},"\u5b9e\u65bd\u7b56\u7565(Implementation Strategy)"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Preparing the necessary changes to support precompiled contracts in the Solana core.",(0,o.kt)("br",{parentName:"p"}),"\n","\u51c6\u5907\u5fc5\u8981\u7684\u66f4\u6539\u4ee5\u652f\u6301 Solana \u6838\u5fc3\u4e2d\u7684\u9884\u7f16\u8bd1\u5408\u7ea6\u3002")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Create pull requests for the Solana core to make these improvements.",(0,o.kt)("br",{parentName:"p"}),"\n","\u4e3a Solana \u6838\u5fc3\u521b\u5efa\u62c9\u53d6\u8bf7\u6c42(pull requests)\u6765\u8fdb\u884c\u8fd9\u4e9b\u6539\u8fdb\u3002")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Testing changes in Testnet.",(0,o.kt)("br",{parentName:"p"}),"\n","\u5728Testnet\u4e2d\u6d4b\u8bd5\u4fee\u6539")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Testing changes in Devnet.",(0,o.kt)("br",{parentName:"p"}),"\n","\u5728Devnet\u4e2d\u6d4b\u8bd5\u4fee\u6539")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Testing changes in Mainnet.",(0,o.kt)("br",{parentName:"p"}),"\n","\u5728Mainnet\u4e2d\u6d4b\u8bd5\u4fee\u6539")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Update Neon EVM to support these precompiled contracts.",(0,o.kt)("br",{parentName:"p"}),"\n","\u66f4\u65b0 Neon EVM \u6765\u652f\u6301\u8fd9\u4e9b\u9884\u7f16\u8bd1\u5408\u7ea6\u3002"))))}d.isMDXComponent=!0}}]);